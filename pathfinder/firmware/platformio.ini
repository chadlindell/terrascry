; PlatformIO Project Configuration for Pathfinder Gradiometer
; https://docs.platformio.org/page/projectconf.html
;
; Build targets:
;   pio run                        # Default: handheld, 4 pairs
;   pio run -e nano_drone          # Drone: 2 pairs, RTK GPS, no beeper
;   pio run -e native              # Host-side unit tests
;   pio test -e native             # Run tests

; Shared library dependencies
[common]
lib_deps =
    adafruit/Adafruit ADS1X15@^2.4.0
    mikalhart/TinyGPSPlus@^1.0.3
    greiman/SdFat@^2.2.0
    adafruit/RTClib@^2.1.1

; === Handheld (default) ===
; 4 sensor pairs, NEO-6M GPS, pace beeper
[env:nanoatmega328]
platform = atmelavr
board = nanoatmega328
framework = arduino
upload_port = /dev/ttyUSB0
upload_speed = 57600
monitor_speed = 115200
lib_deps = ${common.lib_deps}
build_flags =
    -D SERIAL_DEBUG=1
    -D PLATFORM_HANDHELD=1
    -D NUM_SENSOR_PAIRS=4
    -D GPS_BAUD=9600
test_ignore = test

; === Drone ===
; 2 sensor pairs, ZED-F9P RTK GPS, no beeper, GPS quality logging
[env:nano_drone]
platform = atmelavr
board = nanoatmega328
framework = arduino
upload_port = /dev/ttyUSB0
upload_speed = 57600
monitor_speed = 115200
lib_deps = ${common.lib_deps}
build_flags =
    -D SERIAL_DEBUG=1
    -D PLATFORM_DRONE=1
    -D NUM_SENSOR_PAIRS=2
    -D GPS_BAUD=115200
    -D GPS_LOG_QUALITY=1
test_ignore = test

; === Native test environment (runs on host, no hardware needed) ===
[env:native]
platform = native
build_flags =
    -D SERIAL_DEBUG=0
    -D UNIT_TEST=1
test_filter = test_*
