# TERRASCRY Mosquitto MQTT Broker Configuration
# Eclipse Mosquitto 2.x on NVIDIA Jetson

# Listener for MQTT (instruments connect here)
listener 1883
protocol mqtt

# Listener for WebSocket (browser dashboards)
listener 9001
protocol websockets

# Allow anonymous connections (local network only)
# For field deployment, the Jetson runs its own WiFi AP
allow_anonymous true

# Persistence (survives container restart)
persistence true
persistence_location /mosquitto/data/

# Logging
log_dest file /mosquitto/log/mosquitto.log
log_type error
log_type warning
log_type notice
log_type information
connection_messages true
log_timestamp true

# Message size limit (512 bytes covers all TERRASCRY messages)
message_size_limit 1024

# Keepalive and session management
max_keepalive 120

# Retain last status message per instrument
# Instruments publish retained status to terrascry/status/{instrument}
