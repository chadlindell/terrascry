{
  "hash": "6e0e9d1edbe48aeea3aed38d03479bab",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Data Recording\"\n---\n\n## Overview {#sec-recording-overview}\n\nThis section specifies the data formats and organization for HIRT field measurements. Consistent data recording ensures reliable post-processing and long-term data management. The HIRT system generates two primary data types: Magnetic Induction Tomography (MIT) measurements and Electrical Resistivity Tomography (ERT) measurements, each requiring specific record formats to capture all relevant parameters.\n\nAll data files use CSV (Comma-Separated Values) format for maximum compatibility with analysis software. Field logs supplement electronic records with contextual information that may affect data interpretation. The combination of structured electronic records and detailed field notes enables comprehensive quality assessment during post-processing.\n\n::: {.cell execution_count=2}\n\n::: {.cell-output .cell-output-display}\n![HIRT data file organization showing directory structure, file naming conventions, and record field definitions for MIT and ERT data types. Each survey date creates a separate subdirectory containing section-specific measurement files.](11-data-recording_files/figure-pdf/fig-file-structure-output-1.png){#fig-file-structure}\n:::\n:::\n\n\n## Data Acquisition Fundamentals {#sec-data-acquisition-fundamentals}\n\nUnderstanding how HIRT collects data is essential for interpreting the resulting measurements. The system builds a comprehensive 3D picture of the subsurface by systematically cycling through all probe combinations, with each measurement sampling a different region of the ground.\n\n### The Measurement Matrix Concept\n\nHIRT data acquisition is based on a **transmit-receive (TX-RX) matrix**. For an array of N probes:\n\n- Each probe takes turns acting as the **transmitter** (TX)\n- While transmitting, **all other probes** simultaneously act as receivers (RX)\n- This produces N $\\times$ (N-1) unique TX-RX measurements per frequency (MIT) or injection pattern (ERT)\n\nFor a typical 16-probe array, this yields 240 unique measurements per acquisition cycle---each sampling a different geometric path through the subsurface.\n\n### Probe Coordinate System\n\nEach probe is positioned in 3D space and contains sensors at multiple depths:\n\n| Coordinate | Description | Typical Values |\n|------------|-------------|----------------|\n| X | Horizontal position (grid column) | 0 to 10 m |\n| Y | Horizontal position (grid row) | 0 to 10 m |\n| Z | Vertical depth below surface | 0 to -3 m (negative = below ground) |\n\n: Probe coordinate system {#tbl-probe-coordinates}\n\nWithin each probe, multiple sensor rings are spaced along the shaft (e.g., at 0.5 m intervals). A 3 m probe with 0.5 m ring spacing contains **6 electrode rings**, each at a known depth. The complete array therefore samples a 3D volume defined by the probe positions (X, Y) and sensor depths (Z).\n\n::: {.cell execution_count=3}\n\n::: {.cell-output .cell-output-display}\n![HIRT measurement matrix concept. Left: A 4-probe array showing how each probe sequentially transmits while others receive, building a complete TX-RX matrix. Right: The resulting measurement matrix where each cell represents one TX-RX pair measurement. The diagonal is empty (a probe cannot measure itself).](11-data-recording_files/figure-pdf/fig-measurement-matrix-output-1.png){#fig-measurement-matrix}\n:::\n:::\n\n\n### Sequential Acquisition Process\n\nThe HIRT controller automates the measurement sequence, cycling through all TX-RX combinations:\n\n::: {.cell execution_count=4}\n\n::: {.cell-output .cell-output-display}\n![Sequential data acquisition timeline showing how the system cycles through transmitters. Each TX probe activates in turn while all other probes receive simultaneously. For MIT, this cycle repeats at each measurement frequency. For ERT, different injection patterns are used.](11-data-recording_files/figure-pdf/fig-acquisition-sequence-output-1.png){#fig-acquisition-sequence}\n:::\n:::\n\n\n### Building 3D Sensitivity Coverage\n\nEach TX-RX measurement samples a specific region of the subsurface. The **sensitivity volume** for a measurement is the region where changes in conductivity/resistivity would affect the measured signal.\n\n::: {.cell execution_count=5}\n\n::: {.cell-output .cell-output-display}\n![3D sensitivity coverage concept. Left: Cross-section showing how different TX-RX pairs sample different depths and lateral positions. The overlapping sensitivity regions build complete volumetric coverage. Right: Plan view of a 4Ã—4 probe grid showing how the array geometry defines the measurement volume.](11-data-recording_files/figure-pdf/fig-3d-sensitivity-output-1.png){#fig-3d-sensitivity}\n:::\n:::\n\n\n### How a Buried Object Appears in the Data\n\nWhen a conductive object (such as buried metal) is present in the subsurface, it perturbs the electromagnetic field between TX-RX probe pairs. The strength of this perturbation depends on whether the object lies within the sensitivity region of each measurement. By examining which TX-RX pairs show anomalous readings, the inversion algorithm localizes the object in 3D space.\n\n::: {.cell execution_count=6}\n\n::: {.cell-output .cell-output-display}\n![Detection of a buried object through TX-RX cycling. Top row: As each probe transmits in sequence, TX-RX pairs whose sensitivity region intersects the buried target (red star) show elevated responses. Bottom: The resulting measurement matrix shows which probe combinations detected the anomaly, enabling 3D localization.](11-data-recording_files/figure-pdf/fig-object-detection-cycle-output-1.png){#fig-object-detection-cycle}\n:::\n:::\n\n\nThe figure above illustrates the detection process:\n\n1. **Top row:** As each probe takes its turn transmitting (Cycles 1-4), the TX-RX pairs whose sensitivity ellipses overlap the buried target show elevated signal responses (orange paths). Pairs that don't intersect the target show only background response (gray dashed lines).\n\n2. **Bottom left:** The measurement matrix accumulates which TX-RX combinations detected anomalies. The pattern of \"HIGH\" responses reveals that the target lies in a region sensed by P1-P3, P1-P4, P2-P3, P2-P4 pairs (and their reciprocals).\n\n3. **Bottom right:** By finding where the sensitivity regions of the anomalous TX-RX pairs overlap, the inversion algorithm localizes the target in 3D space. The intersection of multiple sensitivity ellipses pinpoints the target position and depth.\n\n::: {.callout-note}\n## From Matrix Pattern to 3D Location\n\nThe inversion algorithm essentially asks: *\"What distribution of subsurface conductivity would produce this specific pattern of TX-RX responses?\"* A localized anomaly creates a characteristic fingerprint in the measurement matrix---strong responses for pairs whose sensitivity intersects the target, background responses elsewhere. The mathematical inversion reconstructs the 3D conductivity distribution that best explains all measurements simultaneously.\n:::\n\n### Key Principles of HIRT Data Structure\n\n| Concept | Description |\n|---------|-------------|\n| **TX-RX Matrix** | Every probe transmits to every other probe, creating N$\\times$(N-1) measurements |\n| **Multi-frequency** | MIT repeats the TX cycle at multiple frequencies (2-50 kHz) for depth discrimination |\n| **Multi-pattern** | ERT uses different injection patterns (Wenner, dipole-dipole) for sensitivity variation |\n| **3D Sensitivity** | Each measurement samples a unique subsurface region; combined coverage fills the volume |\n| **Redundancy** | Reciprocity (A-to-B equals B-to-A) provides built-in quality check |\n\n: Core concepts of HIRT data acquisition {#tbl-acquisition-concepts}\n\n::: {.callout-note}\n## Why This Matters for Interpretation\n\nThe measurement matrix structure means that:\n\n1. **Missing probes** reduce the number of ray paths through certain regions, creating coverage gaps\n2. **Probe spacing** determines the minimum feature size that can be resolved\n3. **Probe depth** limits the maximum depth of sensitivity\n4. **Frequency selection** (MIT) trades off penetration depth vs. near-surface resolution\n:::\n\n## MIT Record Format {#sec-mit-format}\n\nEach MIT measurement records the electromagnetic coupling between a transmitter-receiver probe pair. The record captures both the measurement geometry (which probes, which zone) and the signal parameters (amplitude, phase, frequency) needed for tomographic reconstruction.\n\n| Field | Description | Units/Format |\n|-------|-------------|--------------|\n| timestamp | Measurement time | ISO 8601 or Unix |\n| section_id | Survey section identifier | String (e.g., \"S01\") |\n| zone_id | Zone Hub identifier | String (e.g., \"ZA\") |\n| tx_probe_id | Transmitting probe ID | String (e.g., \"P01\") |\n| rx_probe_id | Receiving probe ID | String (e.g., \"P02\") |\n| freq_hz | Measurement frequency | Hz |\n| amp | Signal amplitude | V or normalized |\n| phase_deg | Phase angle | Degrees |\n| tx_current_mA | TX coil current | mA |\n\n: MIT record format fields {#tbl-mit-format}\n\n## ERT Record Format {#sec-ert-format}\n\nERT measurements record the voltage response to injected current, capturing the electrode geometry and the resulting potential. HIRT uses a sequential ring-pair measurement approach where current is injected between two rings on one probe, and voltage is measured at corresponding ring positions on adjacent probes. This differs from traditional ABMN four-electrode configurations---each HIRT ERT record captures a single voltage measurement at one sensing ring relative to a remote reference (typically the probe's surface ground connection).\n\n::: {.callout-note}\n## ERT Electrode Configuration: Ring-Pair Sequential Measurements\n\nHIRT's borehole geometry uses a simplified three-electrode approach per measurement:\n\n- **A (inject_pos):** Current injection ring (e.g., Ring A at 0.5m on Probe P01)\n- **B (inject_neg):** Current return ring (e.g., Ring B at 1.5m on Probe P01, or ring on adjacent probe)\n- **M (sense):** Voltage measurement ring (e.g., Ring A at 0.5m on Probe P02)\n\nThe reference potential (N) is implicitly the surface ground connection shared by all probes. For each injection pair (A-B), the system sequentially measures voltage at each available sensing ring on all adjacent probes. This approach simplifies hardware (no need for differential voltage measurement between two subsurface rings) while still providing adequate spatial sampling for tomographic reconstruction.\n:::\n\n| Field | Description | Units/Format |\n|-------|-------------|--------------|\n| timestamp | Measurement time | ISO 8601 |\n| section_id | Survey section identifier | String |\n| zone_id | Zone Hub identifier | String |\n| inject_pos_id | Positive current probe/ring ID | String (e.g., P01_RA) |\n| inject_neg_id | Negative current probe/ring ID | String (e.g., P01_RB) |\n| sense_id | Voltage sensing probe/ring ID | String (e.g., P02_RA) |\n| volt_mV | Measured voltage (vs. ground) | mV |\n| current_mA | Injected current | mA |\n| polarity | Current direction | +1 or -1 |\n| notes | Additional notes | Free text |\n\n: ERT record format fields. Probe/ring IDs use format P{nn}_R{A|B|C} to identify both probe number and ring position. {#tbl-ert-format}\n\n### Example ERT Record\n\n```csv\ntimestamp,section_id,inject_pos_id,inject_neg_id,sense_id,volt_mV,current_mA,polarity,notes\n2024-03-15T10:45:12Z,S01,P01_RA,P01_RB,P02_RA,12.5,1.2,+1,\n2024-03-15T10:45:13Z,S01,P01_RA,P01_RB,P02_RB,8.3,1.2,+1,\n2024-03-15T10:45:14Z,S01,P01_RA,P01_RB,P03_RA,6.1,1.2,+1,\n2024-03-15T10:45:15Z,S01,P01_RA,P01_RB,P02_RA,-12.4,1.2,-1,reversed polarity\n```\n\nThe sequence above shows current injected between rings A and B on Probe P01, with sequential voltage measurements at Ring A on P02, Ring B on P02, and Ring A on P03. The final line shows polarity-reversed measurement for electrode polarization correction.\n\n## Probe Registry {#sec-probe-registry}\n\nEach probe in the HIRT system has a registry entry documenting its physical characteristics and calibration status. The probe registry is a shared file that applies across all surveys and enables consistent data interpretation even when probes are swapped between deployments.\n\n| Field | Description | Units/Format |\n|-------|-------------|--------------|\n| probe_id | Unique probe identifier | String |\n| coil_L_mH | TX coil inductance | mH |\n| coil_Q | Coil Q factor | Dimensionless |\n| rx_gain_dB | RX amplifier gain | dB |\n| ring_depths_m | ERT ring depths | m (comma-separated) |\n| firmware_rev | Firmware version | String |\n| calibration_date | Last calibration date | YYYY-MM-DD |\n| notes | Additional notes | Free text |\n\n: Probe registry fields {#tbl-probe-registry}\n\n### Example Probe Registry\n\n```csv\nprobe_id,coil_L_mH,coil_Q,rx_gain_dB,ring_depths_m,firmware_rev,calibration_date,notes\nP01,1.2,25,40,0.5,1.5,v1.2,2024-03-10,\nP02,1.15,28,40,0.5,1.5,v1.2,2024-03-10,\nP03,1.18,26,40,0.5,1.5,v1.2,2024-03-10,\n```\n\n## Survey Geometry File {#sec-survey-geometry}\n\nThe survey geometry file links probe identifiers to their actual field positions, enabling accurate tomographic reconstruction even when probes deviate from ideal grid locations. A new geometry file should be created for each survey deployment.\n\n### File Format\n\n**Filename convention:** `survey_geometry_{YYYY-MM-DD}.csv`\n\n| Field | Description | Units |\n|-------|-------------|-------|\n| probe_id | Probe identifier (matches registry) | String |\n| x_m | X position from grid origin | meters |\n| y_m | Y position from grid origin | meters |\n| z_surface_m | Ground surface elevation (relative) | meters |\n| z_tip_m | Probe tip depth below surface | meters (negative) |\n| status | Deployment status | ACTIVE / PARTIAL / SKIPPED |\n| notes | Field observations | Free text |\n\n: Survey geometry file fields {#tbl-survey-geometry}\n\n### Status Codes\n\n| Status | Meaning | Inversion Handling |\n|--------|---------|-------------------|\n| ACTIVE | Full insertion achieved | All sensors included |\n| PARTIAL | Reduced depth due to obstruction | Exclude sensors below z_tip |\n| SKIPPED | Position not deployed | Omit from geometry |\n\n: Probe status codes and their interpretation {#tbl-status-codes}\n\n### Example Survey Geometry File\n\n```csv\nprobe_id,x_m,y_m,z_surface_m,z_tip_m,status,notes\nP01,0.00,0.00,0.00,-3.00,ACTIVE,reference origin\nP02,2.05,0.12,0.00,-2.95,ACTIVE,offset 12cm for surface root\nP03,4.00,0.00,0.00,-3.00,ACTIVE,\nP04,6.00,0.00,0.00,-3.00,ACTIVE,\nP05,,,,,SKIPPED,large oak tree at position\nP06,1.85,1.92,0.15,-2.10,PARTIAL,hit rock layer at 2.1m\nP07,4.00,2.00,0.08,-3.00,ACTIVE,\nP08,6.10,2.05,-0.05,-3.00,ACTIVE,minor offset for puddle\n```\n\n::: {.callout-note}\n## Recording Best Practice\n\nComplete the survey geometry file **before** leaving the field site. Position measurements are difficult to reconstruct after extraction. Take photographs of the deployed array with visible probe markers as backup documentation.\n:::\n\n### Coordinate System Convention\n\nFor consistency across surveys, adopt a standard local coordinate system:\n\n- **Origin (0, 0, 0):** First probe position or marked survey stake\n- **X-axis:** Primary baseline direction (typically longest dimension)\n- **Y-axis:** Perpendicular to X, following right-hand rule\n- **Z-axis:** Positive upward; surface elevations positive, tip depths negative\n- **Units:** Always meters with two decimal places\n\nWhen using GPS or total station, record the transformation parameters (origin coordinates, rotation angle) to enable conversion between local and absolute coordinates.\n\n## Recording Workflow {#sec-recording-workflow}\n\nThe HIRT data recording workflow follows a systematic process from site preparation through data backup. Each measurement loop captures MIT and ERT data for all probe pairs in a section before moving to the next section. Quality checks at multiple stages ensure data integrity before final storage.\n\n::: {.cell execution_count=7}\n\n::: {.cell-output .cell-output-display}\n![Data recording workflow from field setup through storage. The measurement loop iterates through all probe pairs within each section, recording both MIT and ERT data before advancing. Quality checks and field notes are captured before final backup to multiple storage locations.](11-data-recording_files/figure-pdf/fig-recording-workflow-output-1.png){#fig-recording-workflow}\n:::\n:::\n\n\n## Data Storage {#sec-data-storage}\n\n### File Organization\n\n- **One CSV file per section** for MIT data\n- **One CSV file per section** for ERT data\n- **One registry file** for all probes (shared across surveys)\n- **Paper log** for conditions and notes (backup)\n\n### Naming Convention\n\n- MIT: `MIT_S{section_id}_{date}.csv`\n- ERT: `ERT_S{section_id}_{date}.csv`\n- Registry: `probe_registry.csv`\n- Field Log: `field_log_{date}.txt`\n\n## Metadata Requirements {#sec-metadata}\n\n### Site Information\n\n- Site name and GPS coordinates\n- Survey date and time (start/end)\n- Team members present\n- Weather conditions (temperature, precipitation, wind)\n- Soil type and estimated moisture content\n- Site access notes and restrictions\n\n### Measurement Parameters\n\n- Frequency list for MIT measurements\n- Current levels for ERT measurements\n- Probe spacing configuration\n- Insertion depths achieved\n- Grid coordinates and orientation\n\n## Data Quality Notes {#sec-quality-notes}\n\nField conditions that may affect data quality should be recorded in the paper log or the notes field of individual records. These annotations are critical for proper interpretation during post-processing and help identify measurements that may require special handling or exclusion from analysis.\n\n::: {.callout-note}\n## Record in Paper Log or Notes Field\n\n- Soil moisture changes during survey\n- Temperature variations (especially for long surveys)\n- External disturbances (vehicles, people, machinery)\n- Equipment issues or malfunctions\n- Anomalous readings with contextual explanation\n- Probe insertion difficulties or obstructions\n:::\n\n## Best Practices {#sec-best-practices}\n\n1. **Verify file integrity** after each section by checking record counts match expected probe pair combinations.\n2. **Backup data** to at least two locations before leaving the field site.\n3. **Timestamp all entries** using ISO 8601 format for unambiguous date/time parsing.\n4. **Document probe positions** with photographs showing grid layout and reference markers.\n5. **Record baseline readings** before and after each survey session to detect drift.\n6. **Note environmental changes** including passing weather fronts, irrigation events, or traffic patterns.\n\n::: {.callout-warning}\n## Data Integrity Warning\n\n- Never modify raw data files after collection\n- Create processed copies for any transformations\n- Maintain chain of custody documentation for forensic applications\n- Store original files in read-only archive locations\n:::\n\n## Software Compatibility Roadmap {#sec-software-compatibility}\n\nThe CSV data formats described above are designed as raw intermediate storage. Future software tools will provide import scripts to convert these raw logs into standard formats for open-source inversion frameworks:\n\n- **EIDORS (Matlab/Octave):** Import script will generate .mat structures for MIT-3D finite element reconstruction.\n- **pyGIMLi (Python):** Converters will map ERT data to the Unified Data Format for coupled inversion.\n- **ResIPy:** Direct import support for ERT .csv files is planned.\n\n",
    "supporting": [
      "11-data-recording_files/figure-pdf"
    ],
    "filters": []
  }
}